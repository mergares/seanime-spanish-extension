{
  "id": "animeflv",
  "name": "AnimeFLV",
  "version": "1.1.4",
  "manifestURI": "https://raw.githubusercontent.com/mergares/seanime-spanish-extension/refs/heads/main/manifest.json",
  "language": "typescript",
  "type": "onlinestream-provider",
  "description": "AnimeFLV via local API. Finds episodes (number, title, thumbnail) and lets you choose the stream server.",
  "author": "Your Name",
  "icon": "https://raw.githubusercontent.com/your-username/seanime-extensions/main/animeflv/logo.png",
  "website": "http://100.91.179.28:3003/anime/flv",
  "lang": "es",
  "payload": "class Provider{constructor(){this.baseUrl='http://100.91.179.28:3003/anime/flv';this.lastServers=['Auto'];}getSettings(){return{episodeServers:this.lastServers.length?this.lastServers:['Auto'],supportsDub:false};}async search(opts){try{var q=opts&&opts.query?(''+opts.query).trim():'';if(!q)return[];var looksLikeSlug=true;for(var i=0;i<q.length;i++){var c=q.charAt(i);var ok=(c>='a'&&c<='z')||(c>='A'&&c<='Z')||(c>='0'&&c<='9')||c==='-'||c==='_'||c==='.';if(!ok){looksLikeSlug=false;break;}}if(looksLikeSlug){return[{id:q,title:q,url:this.baseUrl+'/name/'+encodeURIComponent(q),subOrDub:(opts&&opts.dub)?'dub':'sub'}];}var res=await fetch(this.baseUrl+'/search/'+encodeURIComponent(q));if(!res.ok)return[];var d=await res.json();var first=(d&&Array.isArray(d.results))?d.results[0]:(d&&d.anime?d.anime:d);var slug=first&&(first.slug||first.id);var name=first&&(first.name||first.title||slug);if(!slug)return[];return[{id:slug,title:name,url:this.baseUrl+'/name/'+slug,subOrDub:(opts&&opts.dub)?'dub':'sub'}];}catch(e){console.error('Search error:',e);return[];}}async findEpisodes(id){try{var res=await fetch(this.baseUrl+'/name/'+encodeURIComponent(id));if(!res.ok)return[];var a=await res.json();var cover=(a&&a.image&&a.image.url)?a.image.url:'';var eps=(a&&Array.isArray(a.episodes))?a.episodes:[];if(!eps.length)return[];var out=[];for(var i=0;i<eps.length;i++){var e=eps[i]||{};var n=e.number;var t=e&&e.name?e.name:('Episode '+n);var u=e&&e.url?(e.url.indexOf('http')===0?e.url:(this.baseUrl+e.url)):'';var th=e&&e.image?e.image:(cover||undefined);out.push({id:id,number:n,title:t,url:u,thumbnail:th});}return out;}catch(e){console.error('findEpisodes error:',e);return[];}}async findEpisodeServer(episode,chosenServer){var epNum=episode.number;var res=await fetch(this.baseUrl+'/episode/'+encodeURIComponent(String(epNum)));if(!res.ok){throw new Error('Server request failed: '+res.status);}var j=await res.json();var list=(j&&Array.isArray(j.servers))?j.servers:[];if(!list.length){throw new Error('No servers available');}var names=[];for(var i=0;i<list.length;i++){var nm=list[i]&&list[i].name?list[i].name:null;if(nm&&names.indexOf(nm)===-1)names.push(nm);}this.lastServers=['Auto'].concat(names);var selected=undefined;if(chosenServer&&chosenServer!=='Auto'){var wanted=(''+chosenServer).toLowerCase();for(var k=0;k<list.length;k++){var s=list[k];var nm2=s&&s.name?s.name.toLowerCase():'';if(nm2===wanted){selected=s;break;}}if(!selected){for(var m=0;m<list.length;m++){var s2=list[m];var nm3=s2&&s2.name?s2.name.toLowerCase():'';if(nm3.indexOf(wanted)!==-1){selected=s2;break;}}}}if(!selected)selected=list[0];var fileUrl=(selected&&(selected.file_url||selected.url||selected.file))?(selected.file_url||selected.url||selected.file):'';if(!fileUrl)throw new Error('Selected server has no media URL');var vtype=(selected&&selected.type)?selected.type:(fileUrl.slice(-5)==='.m3u8'?'hls':'mp4');return{server:(selected&&selected.name)?selected.name:(chosenServer||'Auto'),headers:{},videoSources:[{url:fileUrl,type:vtype,quality:(selected&&selected.quality?selected.quality:'auto'),subtitles:[]}]} ;}}"
}
